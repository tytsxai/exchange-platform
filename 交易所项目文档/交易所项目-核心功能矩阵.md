---
title: 交易所项目-核心功能矩阵
topic: 项目文档/交易所
tags:
  - 交易所
  - 功能清单
  - 范围
  - 规划
summary: >
  交易所“该有的核心能力”总清单：所有核心功能都按“先实现、可开关”设计，并标注实现阶段与默认启用策略，便于长期开发迭代。
created: 2025-12-21
updated: 2025-12-21
stage: draft
visibility: internal
owner: me
ai_include: true
source: ""
---

# 交易所项目-核心功能矩阵

> 目标：把“交易所该有的核心功能”一次性列全，后续开发按表推进；功能可以不默认启用，但核心能力必须“实现可用 + 可审计 + 可开关”。

## 0 目录
- [[#1 使用方式]]
- [[#2 P0 核心能力（必须实现）]]
- [[#3 P1 增强能力（建议实现）]]
- [[#4 P2 增长能力（可选）]]

---

## 1 使用方式
### 1.1 两个概念：实现 vs 启用
- 实现（Build）：代码与数据模型已具备，能够通过测试与验收。
- 启用（Enable）：通过配置/开关对外开放，进入真实业务流量。

### 1.2 规则（建议默认）
- 所有 P0 能力：必须实现；是否启用由运营/合规/阶段决定。
- 对外行为必须可追溯：资金/风控/配置变更都要有审计与日志。
- 任何“钱”的动作必须走账本（见 [ADR/ADR-002-资金账本与一致性模式.md](ADR/ADR-002-资金账本与一致性模式.md)）。

---

## 2 P0 核心能力（必须实现）
> P0 是“交易所内核”。即使不开放某功能，也要具备实现与开关能力。

### 2.1 账户与安全
| 功能 | 实现阶段 | 默认启用 | 备注/开关 |
|---|---|---|---|
| 注册/登录/找回 | MVP | 启用 | 支持风控（验证码/限流/黑名单） |
| 2FA（TOTP） | MVP | 启用 | 提现/改密/改绑定强制 2FA |
| 设备管理/登录态管理 | V1 | 启用 | 异常登录提醒/强制下线 |
| 防钓鱼码/安全通知 | V1 | 启用 | 邮箱/短信/站内信 |
| API Key 管理（read/trade/withdraw） | MVP | 启用 | 支持 IP 白名单、权限最小化 |
| 子账号/角色（可选） | V2 | 关闭 | 机构场景再开 |

### 2.2 交易（现货）
| 功能 | 实现阶段 | 默认启用 | 备注/开关 |
|---|---|---|---|
| 交易对/规则配置（精度/最小下单/价格保护） | MVP | 启用 | 运营后台可配置 + 审计 |
| 下单/撤单/查询（REST） | MVP | 启用 | 幂等：`clientOrderId` |
| 私有订单回报（WS） | MVP | 启用 | 最终一致；断线可恢复 |
| 撮合引擎（按 `symbol` 分片保序） | MVP | 启用 | 见 [ADR/ADR-001-撮合分片与保序策略.md](ADR/ADR-001-撮合分片与保序策略.md) |
| 订单类型：`LIMIT`/`MARKET` | MVP | 启用 | 先保证正确性与一致性 |
| TIF：`GTC` | MVP | 启用 | `IOC/FOK/POST_ONLY` 可后补 |
| 高级订单：`STOP/TAKE_PROFIT` | V1 | 关闭 | 先实现再灰度 |
| 自成交保护（STP） | MVP | 可选 | 可配置：拒单/取消 maker/取消 taker |
| 手续费（maker/taker） | MVP | 启用 | 阶梯/VIP 可后补 |
| 返佣/推广（如需要） | V1 | 关闭 | 不影响交易内核 |

### 2.3 清算与资金（站内账 + 账本）
| 功能 | 实现阶段 | 默认启用 | 备注/开关 |
|---|---|---|---|
| 账本（LedgerEntry）作为资金 truth | MVP | 启用 | 见 [ADR/ADR-002-资金账本与一致性模式.md](ADR/ADR-002-资金账本与一致性模式.md) |
| 余额快照（available/frozen） | MVP | 启用 | 可重建；并发控制必须正确 |
| 下单冻结/撤单解冻 | MVP | 启用 | 幂等键必须唯一 |
| 成交清算（含手续费） | MVP | 启用 | 不变式：不丢钱、不重记 |
| 人工加减款（运营） | MVP | 关闭 | 必须审计；仅管理员可用 |
| 对账作业（夜间全量） | V1 | 启用 | 异常 0 容忍（P0） |

### 2.4 出入金与钱包（本期启用链上出入金）
| 功能 | 实现阶段 | 默认启用 | 备注/开关 |
|---|---|---|---|
| 资产/链网络配置（Asset/Network） | MVP | 启用 | 运营后台配置 + 审计 |
| 充值地址生成/管理 | MVP | 启用 | 多链/多网络；地址/复用策略见 [ADR/ADR-005-出入金与钱包架构.md](ADR/ADR-005-出入金与钱包架构.md) |
| 充值入账（确认数/回滚处理） | MVP | 启用 | 需要节点/第三方；入账必须走账本 |
| 提现申请/风控/审核/出款 | MVP | 启用 | 地址白名单、2FA、限额、人工审核 |
| 内部划转（用户间/子账号） | V1 | 关闭 | 必须走账本，强一致 |
| 热/冷钱包与出款批处理 | V2 | 关闭 | 安全工程与运维成本高 |
> 钱包与出入金关键策略见：[ADR/ADR-005-出入金与钱包架构.md](ADR/ADR-005-出入金与钱包架构.md)。

### 2.5 行情与市场数据
| 功能 | 实现阶段 | 默认启用 | 备注/开关 |
|---|---|---|---|
| 公共 REST 行情：ticker/depth/trades | MVP | 启用 | depth 快照 + `snapshotSeq` |
| 公共 WS 行情：book/trades/kline | MVP | 启用 | `seq`/断线重拉（见 [ADR/ADR-003-行情链路与回补策略.md](ADR/ADR-003-行情链路与回补策略.md)） |
| K 线聚合与存储 | V1 | 启用 | 回补策略明确 |
| 历史数据导出/归档 | V2 | 关闭 | 成本与合规要求决定 |

### 2.6 风控与开关（必须能“止血”）
| 功能 | 实现阶段 | 默认启用 | 备注/开关 |
|---|---|---|---|
| 限流（IP/用户/API Key/`symbol`） | MVP | 启用 | 触发即返回可解释错误码 |
| 价格保护（偏离阈值/滑点保护） | MVP | 启用 | 防止穿仓/异常成交 |
| 熔断与暂停（全局/按 `symbol`） | MVP | 启用 | 至少支持“只撤单/暂停下单” |
| 异常交易检测（刷单/操纵） | V2 | 关闭 | 需数据与策略体系 |
| 提现风控（限额/黑名单/行为模型） | V2 | 关闭 | 上线提现前必须具备 |

### 2.7 运营后台与审计
| 功能 | 实现阶段 | 默认启用 | 备注/开关 |
|---|---|---|---|
| 交易对/费率/风控规则配置 | MVP | 启用 | 所有变更必须审计 |
| 提现审核/人工处理 | V1 | 关闭 | 启用提现前必须具备 |
| 用户管理（冻结/解冻/风控标记） | V1 | 启用 | 权限最小化 |
| 审计日志（配置/资金/权限） | MVP | 启用 | 不可篡改/留存策略明确 |
> 后台权限与审计模型见：[ADR/ADR-006-后台权限与审计模型.md](ADR/ADR-006-后台权限与审计模型.md)。

### 2.8 合规（基础合规：启用 KYC）
| 功能 | 实现阶段 | 默认启用 | 备注/开关 |
|---|---|---|---|
| KYC 状态机（未认证/审核中/通过/拒绝） | MVP | 启用 | 开启出入金/大额前需启用 |
| AML/制裁名单筛查接口位 | V2 | 关闭 | 对接第三方；留痕 |
| 数据留存与导出 | V2 | 关闭 | 视地区法规 |

### 2.9 合约/杠杆（核心能力预留：先实现、可开关）
| 功能 | 实现阶段 | 默认启用 | 备注/开关 |
|---|---|---|---|
| 合约产品配置（合约、杠杆、手续费、状态） | V2 | 关闭 | 后台可配置 + 审计 |
| 指数价/标记价体系 | V2 | 关闭 | 见 [ADR/ADR-004-合约价格体系（指数-标记价）.md](ADR/ADR-004-合约价格体系（指数-标记价）.md)；强平与风控基于标记价 |
| 资金费率（永续） | V2 | 关闭 | 结算周期、入账链路与账本一致性 |
| 仓位与保证金（逐仓/全仓） | V2 | 关闭 | 仓位、保证金率、风险率计算口径要统一 |
| 强平引擎（Liquidation） | V2 | 关闭 | 触发、执行、穿仓处理、风控与降级 |
| 保险基金/穿仓处理 | V2 | 关闭 | 风险资金池、结算口径与审计 |
| ADL（自动减仓，按需） | V3 | 关闭 | 高复杂度；先预留接口与数据结构 |
| 杠杆借贷（现货杠杆） | V2 | 关闭 | 借贷、利息、强平/爆仓（与合约不同口径） |
> 合约价格体系入口：[`ADR/ADR-004-合约价格体系（指数-标记价）.md`](ADR/ADR-004-合约价格体系（指数-标记价）.md)

### 2.10 通知与公告（核心能力预留）
| 功能 | 实现阶段 | 默认启用 | 备注/开关 |
|---|---|---|---|
| 系统公告（全站/按资产/按 `symbol`） | V1 | 启用 | 配置需审计；用于维护/熔断说明 |
| 安全通知（登录、改密、提币） | V1 | 启用 | 邮箱/短信/站内信（按成本选择） |
| 交易通知（成交通知，按需） | V2 | 关闭 | 可能增加成本与噪音，做开关 |

---

## 3 P1 增强能力（建议实现）
### 3.1 费率与增长
- VIP 阶梯费率、做市计划、返佣与渠道结算
- 活动系统（手续费返还、交易赛）

### 3.2 机构接入
- FIX 接口（或等价高性能通道）
- 子账号/资金账户隔离

### 3.3 报表与财务
- 财务报表、手续费报表、资产负债报表
- 对账与差异处理工作流（运营/财务）

---

## 4 P2 增长能力（可选）
- 跟单/策略交易/网格
- 借贷理财/质押
- 期权/结构化产品
