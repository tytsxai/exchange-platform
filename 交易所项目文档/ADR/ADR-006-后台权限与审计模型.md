---
title: ADR-006-后台权限与审计模型
topic: 项目文档/ADR
tags:
  - 交易所
  - 后台
  - 权限
  - 审计
  - ADR
summary: >
  记录运营后台的权限模型（RBAC）、关键操作的双人复核策略，以及审计日志的结构与留存要求。
created: 2025-12-21
updated: 2025-12-21
stage: draft
visibility: internal
owner: me
ai_include: true
source: ""
---

# ADR-006-后台权限与审计模型

## 背景
- 交易所的“运营后台”拥有最高权限：可以改费率/风控、暂停交易、审批提现、人工加减款。
- 若无严格权限与审计，任何误操作或内部作恶都难以追责与止损。

## 决策（建议默认）
### 1) 权限模型
- 采用 RBAC（Role-Based Access Control）：
  - 用户（AdminUser）可绑定多个角色（Role）
  - 角色包含权限集合（Permission）
  - 权限粒度按“资源 + 动作”定义（如 `SYMBOL:WRITE`、`WITHDRAW:APPROVE`）
- Admin API 与用户 API 分离（域名/网络/鉴权方式分离），默认不对公网暴露。

### 2) 强制审计
- 下列操作必须写 `AdminAuditLog`（不可关闭）：
  - 资金相关：人工加减款、提现审批/拒绝、出款参数修改
  - 交易相关：交易对上线/下线、精度/规则修改、费率修改
  - 风控相关：限流阈值、黑白名单、熔断/开关
  - 权限相关：角色/权限变更、API Key 管理（管理员代操作）
- 审计字段至少包含：操作者、动作、目标、变更前后、时间、来源 IP、关联工单/原因（如有）。

### 3) 双人复核（Four-eyes）
- 下列操作必须双人复核（一个发起，一个审批）：
  - 人工加减款（任何金额）
  - 大额提现审批（阈值可配置）
  - 修改出款关键配置（如提现开关、手续费、白名单策略）

### 4) 留存与告警
- 审计日志留存周期按合规要求配置（默认至少 180 天或更久）。
- 对高风险操作做实时告警（如开启提现、修改费率、批量冻结用户）。

## 备选方案
- 方案 A：仅记录操作日志（无 RBAC/无复核）
  - 缺点：风险极高（不推荐）
- 方案 B：RBAC + 审计（本 ADR 默认）

## 影响
- 正向：降低误操作与内部风险；事故可追责；满足合规审计基本要求。
- 代价：运营效率略降低；需要工单/审批流程配合。

## 验证与回滚
- 验证：
  - 所有高风险接口必须鉴权且权限校验生效
  - 审计日志能完整还原一次变更（before/after）
  - 复核流程无法绕过（含并发与重放）
- 回滚：
  - 不允许关闭审计；若权限系统故障，宁可停用后台关键操作（安全优先）
